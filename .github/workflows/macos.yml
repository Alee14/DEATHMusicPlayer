name: CI

on:
  push:
    branches: 
      - master

jobs:
  build:
    strategy:
      matrix:
        os: [macOS-latest]
      fail-fast: false
    runs-on: ${{ matrix.os }}
    steps:
    - name: "Install Dependencies"
      run: |
        brew install --cask dotnet-sdk
        brew install nodejs
        npm install -g appdmg
    - name: "Build Project"
      run: ./Distribution/build-macos.sh
    - name: "Create Disk Image"
      run: appdmg ./Distribution/app-dmg-spec.json ./FRESHMusicPlayer.dmg
    - uses: actions/upload-artifact@v1
      name: "Upload Artifact"
      with:
        name: "FRESHMusicPlayer.dmg"
        path: "./FRESHMusicPlayer.dmg"